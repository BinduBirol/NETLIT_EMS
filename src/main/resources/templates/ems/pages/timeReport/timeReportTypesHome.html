<!DOCTYPE html>
<html lang="en">
<head th:include="theme/header :: staticheaderFragment"></head>
<body>
	<!-- BEGIN #app -->
	<div id="app" class="app">
		<div th:include="theme/header :: dynamicheaderFragment"></div>
		<div th:include="theme/sidenav :: sidenav"></div>
		<!-- BEGIN #content -->
		<div id="content" class="app-content">
			<ul class="breadcrumb">
				<li class="breadcrumb-item"><a href="#">TIME REPORT MANAGEMENT</a></li>
				<li class="breadcrumb-item active">TYPES</li>
			</ul>

			<h1 class="page-header">Time report types</h1>
			<hr />
			
			<div class="alert alert-primary" th:if="${(param.msg != null)}">
			    [[${param.msg}]]
				 </div>
			
			<button type="button" class="btn btn-outline-theme mb-3"
				onclick="newTemplateModal()" >Add
				a new type</button>






			<table id="datatableDefaultz" class="table table-hover align-middle">
				<thead>
					<tr>
						<th>#</th>
						<th>Name</th>
						<th >Start</th>
						<th>Ends</th>
						<th>Interval</th>
						<th>Type</th>
						<th>Action</th>						
					</tr>
				</thead>
				<tbody>

					<tr th:each="t: ${types}">
						<td>[[${tStat.index+1}]]</td>
						<td>
							<input type="hidden" class="tid" th:value="${t.typeid}"/>
							<input type="hidden" class="typename" th:value="${t.typename}"/>
							<input type="hidden" class="start" th:value="${t.start}"/>
							<input type="hidden" class="end" th:value="${t.end}"/>
							<input type="hidden" class="interval_minutes" th:value="${t.interval_minutes}"/>
							<input type="hidden" class="isOB" th:value="${t.isOB}"/>
							<input type="hidden" class="isWorking" th:value="${t.isWorking}"/>
							
													
							[[${t.typename}]]
						</td>
						<td>[[${t.start}]]</td>
						<td>[[${t.end}]]</td>
						<td>[[${t.interval_minutes}]] Min</td>
						<td>[[${t.isOB}]]</td>
						<td>
							<div class="btn-group">
							  <button onclick="editTemplateModal(event,this)" type="button" class="btn btn-sm btn-outline-info">Edit</button>
							  <button onclick="deleteTemplateModal(event)" type="button" class="btn btn-sm btn-outline-danger">Delete</button>							  
							</div>
						</td>	
					</tr>
				</tbody>
			</table>





			<div class="modal fade" id="typeModal">
				<div class="modal-dialog modal-dialog-centered">
					<div class="modal-content">
						<form action="/dotimeReportTypes" method="post">
							<div class="modal-header">
								<h5 class="modal-title">Types</h5>
								<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
							</div>
							<div class="modal-body">
							

								<div class="form-group mb-3">				
										<div class="form-group mb-3">
											<label class="form-label">Type name</label> 
											<input required="required" class="form-control" name="typename" id="typename"/>
										</div>										
										
										<input type="hidden"   name="typeid" id="typeid"/>
										
								</div>
								
								<div class="row">
									
									<div class="col">
										<div class="form-group mb-3">
											<label class="form-label">Working status</label> 
											<select required="required" onchange="disableDis(this)" id="isWorking" name="isWorking" class="form-select">
												<option value="">Select working status</option>
												<option value="1">Present</option>
												<option value="0">Absent</option>											
											</select>
										</div>
									</div>
									<div class="col">
										<div class="form-group mb-3">
											<label class="form-label">OB status</label> 
											<select required="required" name="isOB" id="isOB" class="form-select">
												<option value="">Select OB status</option>
												<option value="0">Regular time</option>
												<option value="1">Overtime</option>	
											</select>
										</div>
									</div>
								</div>
								

								<div class="row">
									<div class="col">
										<div class="form-group mb-3">
											<label class="form-label">Start</label> 
											<input required="required" onclick="this.showPicker()" type="time" class="form-control dis" id="start" name="start">											</select>
										</div>
									</div>
									<div class="col">
										<div class="form-group mb-3">
											<label class="form-label">Intarval (Minute)</label> 
											<input required="required" type="number" class="form-control dis" id="interval_minutes" name="interval_minutes">											</select>
										</div>
									</div>
									<div class="col">
										<div class="form-group mb-3">
											<label class="form-label">End</label> 
											<input required="required" onclick="this.showPicker()" type="time" class="form-control dis" id="end" name="end">											</select>
										</div>
									</div>
								</div>
								
								<span class="h5">Total hours : </span><span class="h5" id="work_hour"></span>
								&nbsp;<span id="status_str" class="h5"></span>
								

							</div>
							<div class="modal-footer">
								<button type="button" class="btn btn-default"
									data-bs-dismiss="modal">Close</button>
								<button type="submit" class="btn btn-outline-theme">Save
									TR Type</button>
							</div>

						</form>
					</div>
				</div>
			</div>
			
			
			<div class="modal fade" id="deleteModal">
				<div class="modal-dialog modal-dialog-centered">
					<div class="modal-content">
						<form action="/deletetimeReportTypes" method="post">
							<div class="modal-header">
								<h5 class="modal-title">DELETE</h5>
								<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
							</div>
							<div class="modal-body">

								Do you want to delete this type?
								<input id="dtypeid" type="hidden" name="id"/>



							</div>
							<div class="modal-footer">
								<button type="button" class="btn btn-default"
									data-bs-dismiss="modal">Close</button>
								<button type="submit" class="btn btn-outline-danger">Delete
									TR Type</button>
							</div>

						</form>
					</div>
				</div>
			</div>


		</div>
		<!-- END #content -->
		<div th:include="theme/theme_util :: theme_util"></div>
	</div>
	<!-- END #app -->
	<div th:include="theme/footer::staticFooter"></div>
	<script type="text/javascript">
		function editTemplateModal(e,z) {
			$target= $(e.target).closest('tr');
			
			var id=$target.find(".tid").val();
			var typename=$target.find(".typename").val();
			
			var start=$target.find(".start").val();
			var end=$target.find(".end").val();
			var interval_minutes=$target.find(".interval_minutes").val();
			var isOB=$target.find(".isOB").val();	
			var isWorking=$target.find(".isWorking").val();	
			
			
			
			var modal= $("#typeModal");
			
			modal.find(".modal-title").text("#"+id+" "+typename);
			modal.find("input ,select").val("");
			
			modal.find("#typeid").val(id);
			modal.find("#typename").val(typename);
			
			modal.find("#start").val(start);
			modal.find("#end").val(end);
			modal.find("#interval_minutes").val(interval_minutes);			
			
			if (isOB=='true') {
				modal.find("#isOB").val(1);
			} else {
				modal.find("#isOB").val(0);
			}
			
			if (isWorking=='true') {
				modal.find("#isWorking").val(1);
				modal.find(".dis").attr('disabled', false);
				
			} else {
				modal.find("#isWorking").val(0);
				modal.find(".dis").attr('disabled', true);
			}

			modal.modal('show');
		}

		function newTemplateModal() {
			
			var modal= $("#typeModal");
			
			modal.find(".modal-title").text("NEW TR TYPE");
			modal.find("input ,select").val("");
			modal.find('input').attr('disabled', false);
			
			$("#typeModal #typeid").val(0);
			
			modal.modal('show');
		}

		function deleteTemplateModal(e) {
			$target = $(e.target).closest('tr');
			var id=$target.find(".tid").val();
			var typename=$target.find(".typename").val();
			var modal = $("#deleteModal");
			modal.find(".modal-title").text(typename);
			modal.find("#dtypeid").val(id);
			modal.modal('show');
		}
		
		function disableDis(z){
			
			var modal= $("#typeModal");
			var isWorking= $(z).val();
			
			if (isWorking==1) {
				modal.find("#isWorking").val(1);
				modal.find(".dis").attr('disabled', false);
				
			} else {
				modal.find("#isWorking").val(0);
				modal.find(".dis").attr('disabled', true);
			}
		}
	</script>

	
</body>
</html>