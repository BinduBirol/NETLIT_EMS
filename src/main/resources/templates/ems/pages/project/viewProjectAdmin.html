<!DOCTYPE html>
<html lang="en">
<head >
<title>PROJECT</title>
	<link rel="icon" type="image/x-icon" href="assets/img/favicon.ico">
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<meta name="description" content="" />
	<meta name="author" content="" />
	
	<!-- ================== BEGIN core-css ================== -->	
	<link href="assets/css/vendor.min.css" rel="stylesheet" />
	<link href="assets/css/app.min.css" rel="stylesheet" />
	<link href="assets/css/netlit_ems.css" rel="stylesheet" />	
	<!-- ================== END core-css ================== -->	
	<link href="assets/css/pages/projectview.css" rel="stylesheet" />
</head>
<body>
	<!-- BEGIN #app -->
	<div id="app" class="app app-content-full-height">
		<div th:include="theme/header :: dynamicheaderFragment"></div>
		<div th:include="theme/sidenav :: sidenav"></div>
		<!-- BEGIN #content -->
		<div id="content" class="app-content">
			<!-- BEGIN container -->
			<div class="container">

				<ul class="breadcrumb">
					<li class="breadcrumb-item"><a href="#">PROJECT
							MANAGEMENT</a></li>
							<li class="breadcrumb-item"><a href="/projects ">PROJECTS
							</a></li>
					<li class="breadcrumb-item active">PROJECT DETAILS</li>
				</ul>

				<h1 class="page-header">[[${project.title}]]</h1>
				<input type="hidden" id="projectid" th:value="${project.projectid}"/>
					<hr class="mb-4" />
					
	
					
					
					<ul class="nav nav-tabs" id="myTabs">
					  <li class="nav-item me-1"><a href="#home" class="nav-link active" data-bs-toggle="tab">Home</a></li>
					  <li class="nav-item me-1"><a href="#tasks" class="nav-link" data-bs-toggle="tab">Tasks</a></li>
					  <li class="nav-item me-1 dropdown">
					    <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">
					      More
					    </a>
					    <div class="dropdown-menu">
					      <a href="#participants" class="dropdown-item" data-bs-toggle="tab">Participants</a>
					      <a href="#setting" class="dropdown-item" data-bs-toggle="tab">Setting</a>
					    </div> 
					  </li>
					</ul>
					<div class="tab-content pt-3">
					  <div class="tab-pane fade show active" id="home">
							
							<div class="d-flex align-items-start mt-3 mb-3">
							  <a href="#">
							    <img class="rounded" th:src="*{'data:image/jpeg;base64,'+{project.project_image_encoded}}" onerror="this.onerror=null; this.src='assets/img/pages/project.png'"  alt="" width="64" />
							  </a>
							  <div class="ms-3">
							    <h5 class="mt-0 mb-1">[[${project.title}]]</h5>
							    [[${project.description}]]
							  </div>
							</div>
							
							<div class="row">
								<div th:include="ems/content/project/projectActivity :: projectActivity"></div>						
							</div>
							
						
						</div>
					  <div class="tab-pane fade" id="tasks">
					  	<div th:include="ems/content/project/taskContent :: taskContent"></div>
					  </div>
					  <div class="tab-pane fade" id="participants">
					  	<div th:include="ems/content/project/participants :: participants"></div>
					  </div>
					  <div class="tab-pane fade" id="setting">
							<div th:include="ems/content/project/editproject :: editproject"></div>
						</div>
					</div>
					
					
					</div>
			</div>
					
					<div class="modal fade" id="viewEmployee">
				<div class="modal-dialog modal-xl">
					<div class="modal-content empContent">...</div>
				</div>
			</div>			
			
			
		</div>
		
		
	
		<!-- END #content -->
		<div th:include="theme/theme_util :: theme_util"></div>

	<!-- END #app -->
	
	<div th:include="theme/footer::staticFooter"></div>
	<script type="text/javascript">
	
		$('input[type=radio][name=approve]').on('change', function(e) {			
			$target= $(e.target).closest('tr');
			var empid = $target.find(".empidapp").val();			
			$.get("approveEmptoProject",
					  {
					    empid: empid,
					    projectid: $("#projectid").val(),
					    approve: $(this).val()
					  },
					  function(data, status){						
					    $('.toast-header .title').html(status);
						$('.toast-body .toast-message').html(data);					
						$('.toast').toast('show');		
			});			
		});
		
		$(".make-admin").click(function (e) {
			$target= $(e.target).closest('tr');
			var empid = $target.find(".empid").val();
			$.get("makeAdmin",
					  {
					    empid: empid,
					    projectid: $("#projectid").val()					    
					  },
					  function(data, status){ 
						$target.find(".isadmin").html(data);
			});
		})
		
		$(".remove-admin").click(function (e) {
			$target= $(e.target).closest('tr');
			var empid = $target.find(".empid").val();
			$.get("removeAdmin",
					  {
					    empid: empid,
					    projectid: $("#projectid").val()					    
					  },
					  function(data, status){ 
						$target.find(".isadmin").html(data);
						if(data=="Last Admin"){
							$('.toast-header .title').html("Error!");
							$('.toast-body .toast-message').html("Can't remove the only Admin");					
							$('.toast').toast('show');
						}
			});
		})	
		
	</script>
	
	
	 
</body>
</html>